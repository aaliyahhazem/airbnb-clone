<div class="container my-4">
  <div class="card shadow-lg border-0 booking-card">
    <div class="card-header py-3">
      <h4 class="mb-0">
        <i class="bi bi-calendar-check me-2"></i>
        Create Your Booking
      </h4>
    </div>

    <div class="card-body p-4">

      <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()">

        <!-- Dates -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Check-In Date</label>
            <input type="date" class="form-control" formControlName="checkInDate" [min]="today">
          </div>

          <div class="col-md-6">
            <label class="form-label">Check-Out Date</label>
            <input type="date" class="form-control" formControlName="checkOutDate" [min]="minCheckOutDate">
          </div>
        </div>

        <!-- Guests -->
        <div class="mb-3">
          <label class="form-label">Guests</label>
          <input 
            type="number" 
            id="guests" 
            class="form-control"
            formControlName="guests"
            min="1"
            [attr.max]="listingMaxGuests ?? 10">
        </div>

        <!-- Price Summary -->
        <div class="card bg-light border-0 shadow-sm mb-3">
          <div class="card-body">
            <h6 class="fw-bold text-secondary mb-3">Price Summary</h6>

            <div class="d-flex justify-content-between mb-2">
              <span>{{ listingPrice }} EGP Ã— {{ getNumberOfNights() }} nights</span>
              <span class="fw-semibold">{{ listingPrice * getNumberOfNights() }} EGP</span>
            </div>

            <hr>

            <div class="d-flex justify-content-between">
              <strong>Total Price:</strong>
              <strong class="text-danger fs-5">{{ calculateTotalPrice() }} EGP</strong>
            </div>
          </div>
        </div>

        <!-- Errors -->
        <div *ngIf="errorMessage" class="alert alert-danger">
          {{ errorMessage }}
        </div>

        <!-- token debug removed -->

        <!-- Buttons -->
        <div class="d-grid gap-2 mt-4">
          <button class="btn btn-primary btn-lg" [disabled]="!bookingForm.valid || isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            {{ isLoading ? 'Creating Booking...' : 'Continue To Payment' }}
          </button>

          <button 
            type="button" 
            class="btn btn-outline-secondary btn-lg" 
            (click)="onCancel()"
            [disabled]="isLoading">
            Cancel
          </button>
        </div>

      </form>

    </div>
  </div>
</div>
