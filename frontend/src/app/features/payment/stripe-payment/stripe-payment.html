<div class="payment-container">
  <h2>Complete Your Payment</h2>

  <!-- Loading State -->
  <div *ngIf="(isLoading | async) && !bookingLoaded" class="loading">
    <p>Loading booking details...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage" class="error-message">
    <p>{{ errorMessage }}</p>
    <button *ngIf="intentCreationFailed" (click)="retryCreateIntent()" class="btn-retry">
      Retry Payment Setup
    </button>
  </div>

  <!-- Success State -->
  <div *ngIf="successMessage" class="success-message">
    <p>{{ successMessage }}</p>
  </div>
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>

  <!-- Payment Form -->
  <div *ngIf="bookingLoaded && !successMessage" class="payment-form">
    <div class="booking-summary">
      <h3>Booking Summary</h3>
      <p><strong>Booking ID:</strong> #{{ bookingId }}</p>
      <p><strong>Amount:</strong> ${{ amount | number:'1.2-2' }} {{ currency | uppercase }}</p>
    </div>

    <div class="card-element-container">
      <label>Card Details</label>
      <div id="card-element" class="card-element"></div>
    </div>

    <button 
    class="btn btn-primary w-100 py-2"
      (click)="pay()" 
      [disabled]="(isLoading | async) || !bookingLoaded || !amount"
      class="btn-pay">
      <span *ngIf="!(isLoading | async)">Pay ${{ amount | number:'1.2-2' }}</span>
      <span *ngIf="isLoading | async">Processing...</span>
    </button>
  </div>

  <!-- Login CTA -->
  <div *ngIf="showLoginCTA" class="login-cta">
    <p>Please log in to complete your payment.</p>
    <button (click)="loginRedirect()" class="btn-login">Login</button>
  </div>
</div>